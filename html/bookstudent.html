<!DOCTYPE html>
<link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" />
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="/jquery/jquery-1.11.1.min.js"></script>
<link rel="stylesheet" href="syalert/syalert.min.css" />
<script src="syalert/syalert.min.js"></script>
<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图书管理</title>
</head>
<body background="image/570.jpg">

<nav class="navbar navbar-inverse navbar-fixed-top">
    <a href="">BOOK</a>
</nav>
    <input type="text" id="myInput" onkeyup="myFunction()" placeholder="搜索...">

        <table class="responsive-table table" id="myTable" style="font-weight:bold">

            <tr>
                <th>ID</th>
                <th>书名</th>
                <th>作者</th>
                <th>出版社</th>
                <th>类型</th>
                <th> 状态</th>
                <th>操作</th>
            </tr>


        </table>
<ul class="accordion-menu" style="padding: 0">
    <li>
        <div class="dropdownlink"><i class="fa fa-road" aria-hidden="true"></i> 我的书库
            <i class="fa fa-chevron-down" aria-hidden="true"></i>
        </div>
        <ul class="submenuItems">
            <li><a >图书ID:<label id="book1" ></label><button class="myBtn" id="btn1">还书</button></a></li>
            <li><a >图书ID:<label id="book2"></label><button class="myBtn" id="btn2">还书</button></a></li>
            <li><a >图书ID:<label id ="book3"></label><button class="myBtn" id="btn3">还书</button></a></li>
        </ul>
    </li>
</ul>
<div class="sy-alert sy-alert-tips animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="tips" sy-mask="false" id="alert0">
    <div class="sy-content">图书已借出！</div>
</div>
<div class="sy-alert sy-alert-tips animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="tips" sy-mask="false" id="alert1">
    <div class="sy-content">你已经借了三本书了！</div>
</div>
<div class="sy-alert sy-alert-tips animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="tips" sy-mask="false" id="alert2">
    <div class="sy-content">借书成功！</div>
</div>
<div class="sy-alert sy-alert-tips animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="tips" sy-mask="false" id="alert3">
    <div class="sy-content">还书成功！</div>
</div>
<div class="sy-alert sy-alert-tips animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="tips" sy-mask="false" id="alert4">
    <div class="sy-content">还书失败！</div>
</div>
<script>

    var res =bookinfo.getAll();
    var record=bookinfo.queryrecord("213171645");
    for(var j=0;j<record.size();j++){
        if($("#book1").html()==""){
            $("#book1").html(record.elementAt(j).getBookID());
        }else if($("#book2").html()==""){
            $("#book2").html(record.elementAt(j).getBookID());
        }else if($("#book3").html()==""){
            $("#book3").html(record.elementAt(j).getBookID());

        }

    }
    for(var i=0;i<res.size();i++){
    $("#myTable").append("<tr><td>"+(res.elementAt(i).getBookID())+"</td><td>"+(res.elementAt(i).getBookName())+"</td><td>"+(res.elementAt(i).getBookEdit())+"</td><td>"+(res.elementAt(i).getBOOK_PUB())+"</td><td>"+(res.elementAt(i).getCategory())+"</td><td>"+(res.elementAt(i).getState())+"</td><td><button id='borrow' class='myBtn'>借书</button></td></tr>")}
    $(document).on("click",'#borrow',function () {
        var state =$(this).parents("tr").find("td").eq(5).text();
        var ID =$(this).parents("tr").find("td").eq(0).text();
        if($("#book1").html()!==""&&$("#book2").html()!==""&&$("#book3").html()!==""){
            syalert.syopen("alert1");
        } else if(state=="未借"){
            syalert.syopen("alert2");
            $(this).parents("tr").find("td").eq(5).html("已借");
            var newstate=$(this).parents("tr").find("td").eq(5).text();
          bookinfo.update(ID,state,"213171645");
            if($("#book1").html()==""){
                $("#book1").html(ID);
            }else if($("#book2").html()==""){
                $("#book2").html(ID);
            }else if($("#book3").html()==""){
                $("#book3").html(ID);
            }

        } else{
            syalert.syopen("alert0");

        }


    });
    $("#btn1").click(function () {
        var id =$("#book1").html();
        var table,tr,td,i,state;
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        if(id==""){

 syalert.syopen("alert4")
        }
        for(i=1;i<tr.length;i++){
            td=tr[i].getElementsByTagName("td")[0].innerHTML.toUpperCase();
            state=tr[i].getElementsByTagName("td")[5].innerHTML.toUpperCase();
        if(id==td){
                tr[i].getElementsByTagName("td")[5].innerHTML="未借";
                $("#book1").html("");
                bookinfo.update(id,state,"213171645");
        syalert.syopen("alert3");
            }

        }
    });
    $("#btn2").click(function () {
        var id =$("#book2").html();
        var table,tr,td,i,state;
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        if(id==""){
            syalert.syopen("alert4");

        }

        for(i=1;i<tr.length;i++){
            td=tr[i].getElementsByTagName("td")[0].innerHTML.toUpperCase();
            state=tr[i].getElementsByTagName("td")[5].innerHTML.toUpperCase();
            if(id==td){
                tr[i].getElementsByTagName("td")[5].innerHTML="未借";
                $("#book2").html("");
                bookinfo.update(id,state,"213171645");
                syalert.syopen("alert3");
            }

        }
    });
    $("#btn3").click(function () {
        var id =$("#book3").html();
        var table,tr,td,i,state;
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        if(id==""){
            syalert.syopen("alert4");

        }
        for(i=1;i<tr.length;i++){
            td=tr[i].getElementsByTagName("td")[0].innerHTML.toUpperCase();
            state=tr[i].getElementsByTagName("td")[5].innerHTML.toUpperCase();
            if(id==td){
                tr[i].getElementsByTagName("td")[5].innerHTML="未借";
                $("#book3").html("");
                bookinfo.update(id,state,"213171645");
                syalert.syopen("alert3");
            }

        }
    });

    function myFunction() {
        // 声明变量
        var input, filter, table, tr, td, i;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");

        // 循环表格每一行，查找匹配项
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[1];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
    $(function() {
        var Accordion = function(el, multiple) {
            this.el = el || {};
            // more then one submenu open?
            this.multiple = multiple || false;

            var dropdownlink = this.el.find('.dropdownlink');
            dropdownlink.on('click',
                { el: this.el, multiple: this.multiple },
                this.dropdown);
        };

        Accordion.prototype.dropdown = function(e) {
            var $el = e.data.el,
                $this = $(this),
                //this is the ul.submenuItems
                $next = $this.next();

            $next.slideToggle();
            $this.parent().toggleClass('open');

            if(!e.data.multiple) {
                //show only one menu at the same time
                $el.find('.submenuItems').not($next).slideUp().parent().removeClass('open');
            }
        }

        var accordion = new Accordion($('.accordion-menu'), false);
    })
</script>
<style>
    ul {
        list-style: none;
    }

    a {
        text-decoration: none;
    }
    body {
        padding-top: 50px;
    }



    .navbar a {
        color: white;
        line-height: 3em;
    }

    .table-area {
        position: relative;
        z-index: 0;
        margin-top: 50px;
    }

    table.responsive-table {
        display: table;
        /* required for table-layout to be used (not normally necessary; included for completeness) */
        table-layout: fixed;
        /* this keeps your columns with fixed with exactly the right width */
        width: 100%;
        /* table must have width set for fixed layout to work as expected */
        height: 90%;
    }

    table.responsive-table thead {
        position: fixed;
        top: 50px;
        left: 0;
        right: 0;
        width: 100%;
        height: 50px;
        line-height: 3em;
        background: #eee;
        table-layout: fixed;
        display: table;
    }

    table.responsive-table th {
        background: #eee;
    }

    table.responsive-table td {
        line-height: 2em;
    }

    table.responsive-table tr > td,
    table.responsive-table th {
        text-align: left;
    }
    #myInput {
        background-image: url('https://static.runoob.com/images/mix/searchicon.png'); /* 搜索按钮 */
        background-position: 10px 12px; /* 定位搜索按钮 */
        background-repeat: no-repeat; /* 不重复图片 */
        width: 100%;
        font-size: 16px;
        padding: 12px 20px 12px 40px;
        border: 1px solid #ddd;
        margin-bottom: 12px;
    }
    .myBtn{
        line-height: 1.499;
        position: relative;
        display: inline-block;
        font-weight: 400;
        white-space: nowrap;
        text-align: center;
        background-image: none;
        border: 1px solid transparent;
        -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.015);
        box-shadow: 0 2px 0 rgba(0,0,0,0.015);
        cursor: pointer;
        -webkit-transition: all .3s cubic-bezier(.645, .045, .355, 1);
        transition: all .3s cubic-bezier(.645, .045, .355, 1);
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -ms-touch-action: manipulation;
        touch-action: manipulation;
        height: 32px;
        padding: 0 15px;
        font-size: 14px;
        border-radius: 4px;
        color: rgba(0,0,0,0.65);
        background-color: #fff;
        border-color: #d9d9d9;
        color: #fff;
        background-color: #FF5A44;
        border-color: #FF5A44;
        text-shadow: 0 -1px 0 rgba(0,0,0,0.12);
        -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.045);
        box-shadow: 0 2px 0 rgba(0,0,0,0.045);
    }
    .accordion-menu {
        width: 100%;
        max-width: 350px;
        margin: 60px auto 20px;
        background: #fff;
        border-radius: 4px;
    }
    .accordion-menu li.open .dropdownlink {
        color: #CDDC39;
    .fa-chevron-down {
        transform: rotate(180deg);
    }
    }
    .accordion-menu li:last-child .dropdownlink {
        border-bottom: 0;
    }
    .dropdownlink {
        cursor: pointer;
        display: block;
        padding: 15px 15px 15px 45px;
        font-size: 18px;
        border-bottom: 1px solid #ccc;
        color: #212121;
        position: relative;
        transition: all 0.4s ease-out;
    i {
        position: absolute;
        top: 17px;
        left: 16px;
    }
    .fa-chevron-down {
        right: 12px;
        left: auto;
    }
    }

    .submenuItems {
        display: none;
        background: #C8E6C9;
    li {
        border-bottom: 1px solid #B6B6B6;
    }
    }

    .submenuItems a {
        display: block;
        color: #727272;
        padding: 12px 12px 12px 45px;
        transition: all 0.4s ease-out;
    &:hover {
         background-color: #CDDC39;
         color: #fff;
     }
    }

</style>

</body>
</html>
